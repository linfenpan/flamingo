/** by da宗熊 2015/07/22 */!function(t,i){function e(){return this instanceof e?this.init():new e}var n={max:function(t,i){return t=""+t,t&&t.length<=i},min:function(t,i){return t=""+t,t&&t.length>=i},notEmpty:function(t){return t&&!/^\s*$/g.test(t)},url:function(t){return/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(t)},email:function(t){return/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$/.test(t)},number:function(t){return!isNaN(Number(t))},"int":function(t){return/^\d+$/.test(t)}},r=1;e.prototype={init:function(){this._cf={},this._list=[],this._data={},this._valid={},this._cur=null,this._cls=[],this._item={};var t=n;for(var i in t)this.add(i,t[i])},add:function(t,i){return this._valid[t]=i,this[t]=function(){var e=[].slice.call(arguments,0);return e.length===i.length-1&&e.push("fail attribute:"+t),e.unshift(t),this.compile("fn",e.join("|"))},this},define:function(t){var i="valid_define_"+r++;return this.add(i,t),this[i].apply(this,[].slice.call(arguments,1))},_addItem:function(t){if(!this._cf[t]){var i={name:t,vls:[],error:"发生错误:"+t};this._cf[t]=i,this._list.push(i)}},check:function(t){return this._addItem(t),this.compile("name",t)},_newCitem:function(){this._item={then:[],"if":[]},this._cls.push(this._item)},compile:function(t,i){switch(t){case"name":if(this._cur=this._cf[i],this._cur){this._cls=this._cur.vls;var e=this._cls.length;if(e>0){var n=this._cls[e-1];n.then.length>0?this._newCitem():this._item=n}else this._newCitem()}break;case"fn":var r=this._item.then;r.push(i);break;case"then":var r=this._item.then,s=this._item["if"];s.push.apply(s,r),r.splice(0);break;case"end":this._newCitem();break;case"error":this._cur.error=i}return this},end:function(){return this.compile("end")},then:function(){return this.compile("then")},start:function(t,i){"object"==typeof t&&(i=t,t=!1);for(var e=[],n=this._list,r=0,s=n.length;s>r;r++){var h=n[r],a=i[h.name];if(h.name in i)for(var u=this._cf[h.name],c=u.vls,l=0,o=c.length;o>l;l++){var f,_=c[l];if(!(_["if"].length>0&&!this._executeCompileList(_["if"],a,i).res||(f=this._executeCompileList(_.then,a,i),f.res))){if(t){e.push({attr:h.name,error:f.error});break}return{attr:h.name,error:f.error}}}}return t?e:{attr:null,error:!1}},_executeCompileList:function(t,i,e){for(var n=0,r=t.length;r>n;n++){var s=t[n];s=s.split("|");var h=this._valid[s[0]];if(h){var a=h.apply(e||this._valid,[i].concat(s.slice(1,-1)));if(!a)return{res:!1,error:s[s.length-1]}}}return{res:!0,error:""}}},t[i||"PipeValid"]=e}(window,window.PIPEVALID);